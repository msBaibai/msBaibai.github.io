<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<meta http-equiv="Pragma" content="no-cache" />
		<meta http-equiv="Cache-Control" content="no-cache,no-store" />
		<meta http-equiv="Expires" content="0" />
		<meta content="yes" name="apple-mobile-web-app-capable">
		<meta content="white" name="apple-mobile-web-app-status-bar-style">
		<meta content="telephone=no" name="format-detection">
		<meta name="x5-fullscreen" content="true">
		<meta name="full-screen" content="yes">
		<title>会员管理</title>
		<script type="text/javascript" src="js/d.js" ></script>
		<script>
			deleteHTML();
			var zepto="js/zepto.min.js";
			getHTML(zepto,function(text){
				if(!text||text==null||text=="null"||text=="undefined"){
					ajax(zepto,function(jsText){
						addHTML(zepto,jsText);
						eval.call(window,jsText);
						initIndex();
					});
				}else{
					eval.call(window,text);
					initIndex();
				}
			});
			function ajax(url,fn){
				var xmlhttp;
				if (window.XMLHttpRequest){
				  xmlhttp=new XMLHttpRequest();
				}else{
				  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
				}
				xmlhttp.onreadystatechange=function(){
					if (xmlhttp.readyState==4 && xmlhttp.status==200){
						if(!!fn) fn(xmlhttp.responseText);
					}
				}
				xmlhttp.open("GET",url+"?_="+(new Date()).getTime(),true);
				xmlhttp.send();
			}
		</script>
		<style>
			* {
				backface-visibility: hidden;
			}
			::-webkit-scrollbar {
				width: 0px;
			}
			::-webkit-scrollbar-button {}
			::-webkit-scrollbar-track {
				background-color: rgba(225, 225, 225, 0);
			}
			::-webkit-scrollbar-track-piece {
				background-color: rgba(225, 225, 225, 0);
				-webkit-border-radius: 4px;
			}
			::-webkit-scrollbar-thumb {
				background-color: rgba(225, 225, 225, 0);
				border: solid 1px #C0C0C0;
				border-radius: 4px;
			}
			::-webkit-scrollbar-corner { 
				background-color: rgba(225, 225, 225, 0);
			}
			::-webkit-resizer {
				background-repeat: no-repeat;
				background-position: bottom right;
			}
			::-webkit-scrollbar-thumb:hover {
				background-color: rgba(225, 225, 225, 0);
			}
			body {
				margin: 0;
				padding: 0;
				font-size: 0px;
				font-family: 'Helvetica Neue', Helvetica, sans-serif;
				-webkit-user-select: none;
				overflow: hidden;
				background-color: rgba(185, 185, 185, 0.19);
				opacity: 0;
				transition: opacity 0.25s;
				-webkit-transition: opacity 0.25s;
			}
			body.show{
				opacity: 1;
			}
			body>div {
				transform: scale(1, 1);
				-webkit-transform: scale(1, 1);
			}
			ul {
				margin: 0;
				padding: 0;
				list-style: none;
			}
			a {
				cursor: pointer;
			}
		</style>
		<script type="text/javascript">
			var touchLabel = ["input", "select", "button", "a"];
			document.ontouchstart = function(e) {
				if(touchLabel.indexOf(e.target.localName) == -1)
					event.preventDefault();
			}
			var $={};
			function initIndex(){
				var cssList = [];
				cssList.push("a");
				loadCss(cssList,function(){
					document.body.className="show";
				});
				$.pageInit();
			}
		</script>
	</head>

	<body>
		<div class="currentPage">
			<header class="header">
				<h4>会员管理</h4>
			</header>
			<div class="loginFormDiv">
				<ul class="list">
					<li>
						账号
						<input class="userName listInput" type="text" placeholder="请输入安装登记手机号" />
					</li>
					<li>
						密码
						<input class="passWord listInput" type="password" placeholder="密码为手机号后4位" />
					</li>
					<li>
						自动登录
						<span>
						<input type="checkbox" class="switch autoLogin"/>
					</span>
					</li>
				</ul>
				<button class="submitLogin">登录</button>
			</div>
			<script>
				$.pageInit = function() {
					$=Zepto;
					loadJs(["b"], function() {
						$.baseUrl = $.getRootPathAndPort();
						var user_name = localStorage.getItem("user_name");
						var user_pwd = localStorage.getItem("user_pwd");
						if(!!user_name) {
							$(".userName").val(user_name);
							$(".passWord").val(user_pwd);
							$(".autoLogin")[0].checked=true
						}
						function login(obj, fn) {
							$.ajax({
								type: "post",
								url: $.baseUrl + "/userLogin",
								dataType: "json",
								data: obj,
								success: function(json) {
									if(!!fn)
										fn(json);
								}
							});
						}
						$(".submitLogin").tap(function() {
							var obj={};
							obj.user_name = $(".userName").val();
							obj.user_pwd = $(".passWord").val();
							if(!obj.user_name||!obj.user_pwd)
								return $.alt("请填写账号及密码");
							$(".loading").show();
							login(obj, function(json) {
								$(".loading").hide();
								if(json.code == 1 && json.data != "error") {
									var arr = json.data;
									if(arr.length>0)
										$.user=arr[0];
									if($(".autoLogin")[0].checked==true){
										localStorage.setItem("user_name", obj.user_name);
										localStorage.setItem("user_pwd", obj.user_pwd);
									}else{
										localStorage.setItem("user_name", "");
										localStorage.setItem("user_pwd", "");
									}
									$.toHref("memberInfo.html");
									
								} else {
									$.alt("账号或密码错误！");
								}
							});
						});
					});
				};
			</script>
		</div>
	</body>
	<foot>
		<div class="confirmBox">
			<div>
				<span></span>
				<span></span>
				<div>
					<span>是</span>
					<span>否</span>
				</div>
			</div>
		</div>
		<div class="confirmBoxInput">
			<div>
				<span></span>
				<span></span>
				<input type="text" placeholder="" />
				<div>
					<span>是</span>
					<span>否</span>
				</div>
			</div>
		</div>
		<div class="confirmBoxOK">
			<div>
				<span></span>
				<span></span>
				<div>
					<span>是</span>
				</div>
			</div>
		</div>
		<div class="loading" style="display: none;"></div>
	</foot>

</html>